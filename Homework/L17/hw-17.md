**Цель: получить практический опыт написания** **SQL****- запросов**
**Задание 1:**
**Вводные данные**:

Есть таблица анализов Analysis:

- an_id — ID анализа;
- an_name — название анализа;
- an_cost — себестоимость анализа;
- an_price — розничная цена анализа;
- an_group — группа анализов.

Есть таблица групп анализов Groups:

- gr_id — ID группы;
- gr_name — название группы;
- gr_temp — температурный режим хранения.

Есть таблица заказов Orders:

- ord_id — ID заказа;
- ord_datetime — дата и время заказа;
- ord_an — ID анализа.

Далее мы будем работать с этими таблицами.(Создал таблицу и заполнил данными.)
**Формулировка:** вывести название и цену для всех анализов, которые продавались 5 февраля 2020 и всю следующую неделю.

```sql
SELECT DISTINCT Analysis.an_name, Analysis.an_price
FROM Orders
JOIN Analysis ON Orders.ord_an = Analysis.an_id
WHERE DATE(Orders.ord_datetime) BETWEEN '2020-02-05' AND '2020-02-11';
```
  
  ![](screenshots/Pasted%20image%2020250516115725.png)
  
**Задание 2(опционально):**

Используя left join, напишите запрос, который будет выводить список всех студентов и названий их курсов, которые они изучают. Если у студента нет курсов, то вместо названия курса нужно выводить NULL. Для этого вам необходимо связать таблицы "Студенты" и "Курсы".

Создали таблицы и наполнили данными:

![](screenshots/Pasted%20image%2020250516143623.png)

```sql
SELECT 
    Студенты.student_name,
    Курсы.course_name
FROM 
    Студенты
LEFT JOIN 
    Курсы ON Студенты.student_id = Курсы.student_id;
```

![](screenshots/Pasted%20image%2020250516143901.png)

**Задание 3:**

Шаги:

1. Создайте бэкап базы данных. Для этого используйте команду "mysqldump" для создания полного дампа базы данных. Сохраните файл дампа в безопасном месте, таком как внешний жесткий диск или облачное хранилище.

```bash
mysqldump -u root -p mydatabase > mydatabase_16.05.2025.sql
```

1. Измените какие-либо данные в базе данных, например, добавьте новую таблицу или обновите информацию в существующей таблице.	

![](screenshots/Pasted%20image%2020250516130526.png)

3. Восстановите базу данных из бэкапа, чтобы вернуть ее в исходное состояние. Для этого используйте команду "mysql" и укажите имя базы данных и файл дампа для восстановления.

```bash
# Удалить базу данных
mysql -u root -p -e "DROP DATABASE mydatabase;"
# Создать новую пустую базу
mysql -u root -p -e "CREATE DATABASE mydatabase;"
# Восстановить из бэкапа
mysql -u root -p mydatabase < mydatabase_16.05.2025.sql
```

3. Убедитесь, что база данных была восстановлена успешно, проверив данные и таблицы в базе данных.

![](screenshots/Pasted%20image%2020250516132426.png)

4. Создайте скрипт, который будет автоматически создавать бэкап базы данных и отправлять его на удаленный сервер для хранения. Например, вы можете использовать инструмент "cron" для регулярного создания бэкапов и передачи их на удаленный сервер по расписанию.

```bash
#!/bin/bash

# Настройки
DB_USER="root"
DB_PASS=$DB_PASSWORD
DB_NAME="mydatabase"

REMOTE_USER="user"
REMOTE_HOST="backup.example.com"
REMOTE_DIR="/backup/db"

# Имя файла с датой
DATE=$(date +"%d.%m.%Y")
BACKUP_FILE="${DB_NAME}_${DATE}.sql"

# 1. Создание бэкапа
mysqldump -u$DB_USER -p$DB_PASS $DB_NAME > /tmp/$BACKUP_FILE

# 2. Копируем на удалённый сервер
scp /tmp/$BACKUP_FILE $REMOTE_USER@$REMOTE_HOST:$REMOTE_DIR/
```

```bash
crontab -e
```
Добавим для ежедневного бэкапа в 2:00 ночи:
```bash
0 2 * * * /usr/local/bin/db_backup.sh >> /var/log/db_backup.log 2>&1
```


