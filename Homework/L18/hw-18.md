## Домашнее задание №18

##### Цель: научиться реализовывать отказоустойчивое решение для баз данных (на примере Postgresql)

--- 
### Задание 1: 

##### 1.Создать два сервера, установить на них PostgreSQL и подключить их к одной сети.

![](screenshots/Pasted%20image%2020250617182420.png)

![](screenshots/Pasted%20image%2020250617182509.png)

##### 2.Настроить репликацию между серверами, чтобы изменения, вносимые на одном сервере, автоматически реплицировались на другой.


- Проверить статус репликации на мастере:

```sql
sudo -u postgres psql -c "SELECT * FROM pg_stat_replication;"
```

![](screenshots/Pasted%20image%2020250617190125.png)

- Проверить, является ли текущий сервер слейвом:

```sql
sudo -u postgres psql -c "SELECT pg_is_in_recovery();"
```

![](screenshots/Pasted%20image%2020250617190151.png)

Cоздали тестовую бд с таблицей test_table на сервере master,с помощью репликации данные дублировались на сервер slave:

![](screenshots/Pasted%20image%2020250617191258.png)

![](screenshots/Pasted%20image%2020250617191437.png)

##### 3.Настроить отказоустойчивость, используя репликацию и механизм автоматического переключения между серверами.

Установка `repmgr` на оба сервера:

```bash
sudo apt install postgresql-16-repmgr
```

##### 4.Проверить работу отказоустойчивого решения, симулируя отказ одного из серверов и убедившись, что второй сервер продолжает работу и все данные сохранены.

```bash
sudo systemctl stop postgresql
```

![](screenshots/Pasted%20image%2020250617223633.png)

--- 
### Опционально:

- ##### Настроить систему резервного копирования, чтобы регулярно создавать бэкапы данных и сохранять их на отдельном сервере.
- ##### Документировать все шаги по настройке и проверке отказоустойчивого решения и подготовить отчет о выполненной работе.

--- 
